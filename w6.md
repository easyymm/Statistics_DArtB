# 통계학 6주차 정규과제

📌통계학 정규과제는 매주 정해진 분량의 『*데이터 분석가가 반드시 알아야 할 모든 것*』 을 읽고 학습하는 것입니다. 이번 주는 아래의 **Statistics_6th_TIL**에 나열된 분량을 읽고 `학습 목표`에 맞게 공부하시면 됩니다.

아래의 문제를 풀어보며 학습 내용을 점검하세요. 문제를 해결하는 과정에서 개념을 스스로 정리하고, 필요한 경우 추가자료와 교재를 다시 참고하여 보완하는 것이 좋습니다.

6주차는 `3부. 데이터 분석하기`를 읽고 새롭게 배운 내용을 정리해주시면 됩니다.


## Statistics_6th_TIL

### 3부. 데이터 분석하기
### 12.통계 기반 분석 방법론



## Study Schedule

|주차 | 공부 범위     | 완료 여부 |
|----|----------------|----------|
|1주차| 1부 p.2~56     | ✅      |
|2주차| 1부 p.57~79    | ✅      | 
|3주차| 2부 p.82~120   | ✅      | 
|4주차| 2부 p.121~202  | ✅      | 
|5주차| 2부 p.203~254  | ✅      | 
|6주차| 3부 p.300~356  | ✅      | 
|7주차| 3부 p.357~615  | 🍽️      |

<!-- 여기까진 그대로 둬 주세요-->

# 12.통계 기반 분석 방법론

```
✅ 학습 목표 :
* 주성분 분석(PCA)의 개념을 설명할 수 있다.
* 다중공선성을 진단할 수 있다.
* Z-TEST와 T-TEST의 개념을 비교하고, 적절한 상황에서 검정을 설계하고 수행할 수 있다.
* ANOVA TEST를 활용하여 세 개 이상의 그룹 간 평균 차이를 검정하고, 사후검정을 수행할 수 있다.
* 카이제곱 검정을 통해 범주형 변수 간의 독립성과 연관성을 분석하는 방법을 설명할 수 있다.
```

## 📍 12.1. 분석 모델 개요

![Image](https://github.com/user-attachments/assets/c8cc26df-869e-40e2-8422-a368d67b034d)

▪️ **통계 모델**: 모형과 해석 중요, 오차와 불확정성 강조

▪️ **기계 학습**: 대용량 데이터를 활용하여 예측 정확도를 높이는 것 중요

![Image](https://github.com/user-attachments/assets/71891d9e-0b8e-455f-aabd-0bf32541d1a2)

![Image](https://github.com/user-attachments/assets/bd62a7c5-bd28-41cb-9b3f-4bbf07e7cdc6)

▪️ 기계학습 데이터 분석 방법론

🔹 종속변수의 유무 -> 지도학습, 비지도학습, 강화학습  
🔹 독립변수와 종속변수의 속성 -> 질적 척도, 양척 척도(절대적 구분은 아님)

![Image](https://github.com/user-attachments/assets/c66a96fe-3e02-42b4-9e32-f2bdd69badbd)

▪️ **지도학습**: 정답 있음. 결괏값과 정답 사이 오차가 줄어들도록 학습과 모델 수정 반복.  
▪️ **비지도학습**: 별도 정답 없이 변수 간 패턴을 파악하거나 데이터를 군집화.  
▪️ **강화학습**: 동물이 시행착오를 통해 학습하는 과정을 기본 개념으로 한 방법. 모델의 결과에 보상과 벌을 주면서 스스로 학습하게 함.


## 📍 12.2. 주성분 분석(PCA)


▪️ 여러 개의 독립변수들을 잘 설명해 줄 수 있는 주된 성분을 추출하는 기법. 독립변수(차원)의 수를 줄일 수 있음. (차원의 저주 방지) 

▪️ 모형을 간단하게 만들고 분석 결과를 효과적으로 해석 가능

▪️ 사용되는 변수들이 모두 등간 척도나 비율 척도로 측정한 양적 변수여야 하며, 관측치들이 서로 독립적이고 정규분포를 이루고 있어야 함.

▪️ 차원을 줄이는 방법

🔹 변수 선택을 통해 비교적 불필요하거나 유의성이 낮은 변수 제거  
🔹 변수들의 잠재적 성분을 추출(-> 주성분분석(PCA), 공통요인분석(CFA))

▪️ 일반적으로는 제1주성분, 제2주성분만으로 대부분의 설명력이 포함되므로 두 개의 주성분만 선정함

▪️ 변수 간 스케일 차이가 클 경우, 분산이 큰 변수가 주성분에 과도하게 영향을 주기 때문에 정규화(또는 표준화 등 다른 스케일링 방법)를 적용한다.

## 📍 12.3. 공통요인분석(CFA)

▪️ PCA와 CFA는 요인분석(FA)을 하기 위한 기법의 종류. 요인분석을 하기 위해 전체 분산을 토대로 요인을 추출하는 PCA를 사용하거나, 공통분산만을 토대로 요인을 추출하는 CFA를 선택할 수 있음.

▪️ **요인분석**

🔹 **탐색적 요인분석(EFA)**: 변수와 요인 간 관계가 사전에 정립되지 않거나 체계화되지 않은 상태에서 변수 간 관계를 알아보기 위해 사용  
🔹 **확인적 요인분석(CFA)**: 이미 변수들의 속성을 예상하고 있는 상태에서 실제로 구조가 그러한지 확인하기 위한 목적. 보통 선행연구로 밝혀진 변수의 속성을 활용하여 측정변수와 잠재변수 간 관계를 검정 및 확인하기 위해 사용.

▪️ 상관성 높은 변수들을 묶어 잠재된 몇 개의 변수를 찾는다. 정확성 면에서는 PCA보다 우수한 면이 있다.

▪️ PCA는 모든 독립변수들의 총 변량(총 분산)을 기반으로 요인을 추출하므로 전체 변수를 가장 잘 설명해주는 순으로 주성분의 우위가 결정됨 / CFA는 변수들 간 공통변량만을 기반으로 하여 요인 추출하므로 우위 개념이 없다.

▪️ 요인분석을 위해서는, 독립변수들 간 상관성이 요인분석에 적합한지 검증해야 함

▪️ **바틀렛 테스트**: 행렬식을 이용하여 카이제곱값을 구하여 각 변수들 사이 상관계수의 적합성을 검증, 유의확률 p값으로 나타냄. p값<0.05면 대각 행렬이 아니다, 즉 변수들 간 상관관계가 있다는 뜻이므로 분석에 적합하다고 판단.  

▪️ 요인분석은 변수 그룹 간 상관관계가 각각 달라야 요인이 다르게 분리되므로, 변수들의 상관관계가 모두 비슷하게 높거나 낮게 나타나면 요인분석에 부적합함.

▪️ **KMO 검정**

🔹 변수들 간 상관관계가 다른 변수에 의해 잘 설명되는 정도를 나타내는 값을 통계적으로 산출하는 검정 방법.  
🔹 독립변수들 간 상관계수 제곱들과 편상관계수들을 모두 더한 값에서 상관계수 제곱의 합이 차지하는 비율 값. 일반적으로 0.8 이상이면 우수, 0.5 이상이면 적합, 0.5 미만이면 부적합으로 봄.  
🔹 적합성 검증 후에는 요인분석을 통해 생성되는 주성분 변수들의 고유치를 확인하여 요인의 개수 결정  
*고유치: 요인이 설명해주는 분산의 양을 뜻하는 것, 요인에 해당하는 변수들의 요인 적재 값의 제곱합 값들을 합하여 구함.  
🔹 고유치 1 = 해당 요인이 변수 하나만큼의 분산을 가지고 있음. 사회과학에서는 고유치가 1 이상인 요인만 선택하며, 총 분산의 60% 이상을 설명해주는 요인까지 선정하는 것이 일반적. 설명력이 너무 낮으면 정보 손실이 커지는 문제 발생.  
🔹 스크리 도표: 요인 수에 따른 고유치 변화를 그래프로 나타낸 것. 이를 통해 직관적으로 고유치를 확인할 수 있으며, 그래프의 경사가 낮아지는 지점(엘보우 포인트)을 통해 적정한 요인을 선정하는 데 참고할 수 있음.  

## 📍 12.4. 다중공선성 해결과 섀플리 밸류 분석

▪️ **다중공선성**: 추정치의 통계적 유의성이 낮아져 모델의 정합성이 맞지 않는 문제 발생. 

▪️ 다중공선성 판별 기준

🔹 회귀 분석 모델 실행 전 상관분석을 통해 독립 변수 간 상관성을 확인하여 높은 상관계수를 갖는 독립변수를 찾아내기. 변수가 많을 경우 상관성 파악이 힘듦.  
🔹 회귀 분석 결과에서 R2값은 크지만 t값이 낮다면 다중공선성 의심. 종속변수에 대한 독립변수들의 설명력은 높지만 각 계수 추정치의 표준 오차가 크다는 것은 독립변수 간 상관성이 크다는 것을 의미하기 때문. t값은 표준오차(노이즈) 대비 시그널을 뜻하는 값이므로 클수록 좋다.

![Image](https://github.com/user-attachments/assets/ec5af00d-853e-41cd-8505-c7b97e729d3b)

🔹 **VIF(분산팽창계수)**: 다른 변수들에 의해 설명되는 수준이 높을수록 큰 값을 가지게 됨. 일반적으로 5 이상이면 다중공선성 의심, 10 이상일 경우 있다고 판단. VIF에 루트를 씌운 값은 해당 변수가 다른 변수들과의 상관성이 없는 경우보다 표준오차가 X배 높다는 것 의미.

▪️ 다중공선성 해결 방법

🔹 **VIF값**이 높은 변수들 중 종속변수와의 상관성(설명력)이 가장 낮은 변수를 제거하고 다시 값 확인하기. 가설과 비즈니스적 요소도 함께 고려하여 변수를 제거하여야 함.  
🔹 **표본 관측치를 추가적으로 확보**하여 다중공선성을 완화하는 방법. 일반적으로 분석 모수가 많아질수록 회귀계수의 분산과 표준오차가 감소함.  
🔹 **변수를 가공**하여 변수 간 상관성을 줄이는 방법. 로그를 취하거나 표준화 및 정규화 변환, 연속형 변수 구간화 또는 명목변수로 변환하는 등.  
🔹 **주성분분석**: 기존 변수의 변동을 가장 잘 설명하는 변수를 찾아낸 것이므로 효과가 있으나. 변수의 해석이 어려워짐.  
🔹 데이터 분석 환경에서 제공하는 **변수 선택 알고리즘** 활용: 전진선택법, 후진제거법, 단계적선택법 중 하나를 선택하여 특정 로직에 의해 모형에 적합한 변수 자동으로 선정.

▪️ **섀플리 밸류**: 해당 변수를 모델에 투입했을 때 설명력에 어느 정도의 기여를 하는지 측정하는 기준값으로 활용

## 📍 12.6. Z-test와 T-test

▪️ Z-test와 T-test

🔹 통계 기반 데이터 분석의 기본 방법론, 집단 내 혹은 집단 간 평균값 차이가 통계적으로 유의미한 것인지 알아내는 방법.
🔹 단일 표본 집단의 평균 변화를 분석하거나 두 집단의 평균값 혹은 비율 차이를 분석할 때 사용. 
🔹 양적 변수, 정규 분포, 등분산이어야 함.
🔹 모집단을 알 수 있는지, 표본의 크기에 따라 달라짐. Z-test는 모집단의 분산을 알 수 있는 경우 사용하나, 모르더라도 표본 크기가 30 이상이면 중심 극한 정리에 의해 표본 평균분포가 정규분포를 따르므로 사용 가능.
🔹 T-test는 표본 크기가 30 미만이라 표본 집단의 정규분포를 가정할 수 없을 때 사용하나 30 이상일 떄에도 사용 가능.

![Image](https://github.com/user-attachments/assets/f60dbdd3-f4e2-4482-a744-e8abf3a1b072)

▪️ Z-test

🔹 단일 표본 Z-test
🔹 두 표본 Z-test
🔹 비율 Z-test

▪️ T-test

🔹 단일 표본 T-test
🔹 독립 표본 T-test
🔹 대응 표본 T-test


## 📍 12.7. ANOVA

▪️ 세 집단 이상의 평균 차이를 검정할 때 사용. T-test로도 여러 번 중복하여 검정이 가능하나 신뢰도 하락 문제가 있음. 

![Image](https://github.com/user-attachments/assets/5b7ff575-d891-45f6-9906-9626c072b1ed)

▪️ F분포 사용. 두 모분산의 비교 및 검정을 위해 사용. 양의 값을 가지며 오른쪽으로 긴 꼬리 형태를 보임. ANOVA나 회귀분석 등에서 F분포를 통해 독립변수가 종속변수에 미치는 영향을 분석. 

▪️ 독립변수인 요인의 수에 따라 다르게 불림.  
🔹 일원분산분석/이원분산분석/N원분산분석

▪️ ANOVA는 각 집단의 평균값 차이가 통계적으로 유의한지 검증하므로, 각 집단의 평균이 서로 멀리 떨어져 있어 집단 평균의 분산이 큰 정도를 따져서 집단 간 평균이 다른지를 판별 -> **집단 내 분산, 집단 간 평균의 분산** 사용

▪️ 사후검증: 독립변수 수준 사이에서 평균의 차이를 알고자 할 때 사용.  
🔹 Turkey HSD 검증(집단의 수가 같을 때), Scheffe 검증(집단의 수가 다를 때)



## 📍 12.8. 카이제곱 검정(교차분석)

▪️ 명목 혹은 서열척도와 같은 범주형 변수들 간 연관성을 분석하기 위해 결합분포를 활용하는 방법. 

▪️ 연관성의 정도를 수치로 표현할 수 없으므로 검정 통계량 카이제곱을 통해 변수 간 연관성이 없다는 귀무가설을 기각하는지 여부로 상관성을 판단한다.


<br>
<br>

# 확인 문제

### **문제 1.**
> **🧚 경희는 다트비 교육 연구소의 연구원이다. 경희는 이번에 새롭게 개발한 교육 프로그램이 기존 프로그램보다 학습 성취도 향상에 효과적인지 검증하고자 100명의 학생을 무작위로 두 그룹으로 나누어 한 그룹(A)은 새로운 교육 프로그램을, 다른 그룹(B)은 기존 교육 프로그램을 수강하도록 하였다. 실험을 시작하기 전, 두 그룹(A, B)의 초기 시험 점수 평균을 비교한 결과, 유의미한 차이가 없었다. 8주 후, 학생들의 최종 시험 점수를 수집하여 두 그룹 간 평균 점수를 비교하려고 한다.**   

> **🔍 Q1. 이 실험에서 사용할 적절한 검정 방법은 무엇인가요?**

```
독립표본 t-test.
두 집단 간 평균 점수의 차이를 검정해야 함.
```

> **🔍 Q2. 이 실험에서 설정해야 할 귀무가설과 대립가설을 각각 작성하세요.**

```
H0: 두 교육 프로그램 간 학습 성취도 차이가 없다.(두 집단 간 최종 시험 점수 평균에 차이가 없다.)
H1: 새 교육 프로그램이 기존보다 학습 성취도 향상에 차이가 있다.(A 집단의 평균 점수가 B보다 높다.단측검정일 때)
```

> **🔍 Q3. 검정을 수행하기 위한 절차를 순서대로 서술하세요.**

<!--P.337의 실습 코드 흐름을 확인하여 데이터를 불러온 후부터 어떤 절차로 검정을 수행해야 하는지 고민해보세요.-->

```python
# 데이터 확인
df.head()
df.describe()

# A, B 그룹 박스플롯 시각화
df =  pd.melt(df)
plt.figure(figsize=(12,6))
sns.boxplot(x='variable', y='value', data=df2)
plt.title('교육 프로그램 비교')
plt.show()

# 정규성 검정 (Shapiro-Wilk Test)
print("Shapiro Test - Group A:", shapiro(df['group_A']))
print("Shapiro Test - Group B:", shapiro(df['group_B']))

# 등분산성 검정 (Bartlett Test)
print("Bartlett Test:", bartlett(df['group_A'], df['group_B']))

# 독립표본 t-검정
ttest_ind(df['group_A'], df['group_B'], equal_var=False)
```

> **🔍 Q4. 이 검정을 수행할 때 가정해야 하는 통계적 조건을 설명하세요.**

```
독립성, 정규성, 등분산성
```

> **🔍 Q5. 추가적으로 최신 AI 기반 교육 프로그램(C)도 도입하여 기존 프로그램(B) 및 새로운 프로그램(A)과 비교하여 성취도 차이가 있는지 평가하고자 한다면 어떤 검정 방법을 사용해야 하나요? 단, 실험을 시작하기 전, C 그룹의 초기 점수 평균도 A, B 그룹과 유의미한 차이가 없었다고 가정한다.**

```
ANOVA.
3개 이상의 집단 간 평균 차이 검정.
```

> **🔍 Q6. 5번에서 답한 검정을 수행한 결과, 유의미한 차이가 나타났다면 추가적으로 어떤 검정을 수행해 볼 수 있을까요?**

```
사후검정
```

---

### **문제 2. 카이제곱 검정**  
> **🧚 다음 중 어떠한 경우에 카이제곱 검정을 사용해야 하나요?   
1️⃣ 제품 A, B, C의 평균 매출 차이를 비교하고자 한다.  
2️⃣ 남성과 여성의 신체 건강 점수 평균 차이를 분석한다.  
3️⃣ 제품 구매 여부(구매/미구매)와 고객의 연령대(10대, 20대, 30대…) 간의 연관성을 분석한다.  
4️⃣ 특정 치료법이 환자의 혈압을 감소시키는 효과가 있는지 확인한다.**  

```
3️⃣, 카이제곱 검정은 범주형 변수 간 관계 분석시 사용.
```

### 🎉 수고하셨습니다.